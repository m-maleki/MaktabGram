@using MaktabGram.Domain.Core.UserAgg.Contracts
@using MaktabGram.Domain.Core.UserAgg.Contracts.User
@using MaktabGram.Presentation.RazorPages.Extentions
@{
    @inject IUserApplicationService userApplicationService;
    @inject ICookieService cookieService;
}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - مکتب گرام</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Vazirmatn Font -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Site RTL Styles -->
    <link rel="stylesheet" href="~/css/site-rtl.css" asp-append-version="true" />

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="overflow-x-hidden">

    <!-- هدر ثابت (مشترک همه صفحات) -->
    <header class="fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-50 shadow-sm">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <!-- لوگو -->
            <a href="/" class="text-2xl font-bold app-logo">مکتب گرام</a>

            <!-- عنوان صفحه (اختیاری - فقط در صفحات خاص نمایش داده می‌شود) -->
            <div class="hidden sm:block text-lg font-semibold text-gray-700">
                @if (ViewData["PageTitle"] != null)
                {
                    <span>@ViewData["PageTitle"]</span>
                }
            </div>

            <!-- آیکون‌های ناوبری -->
            <nav class="flex items-center gap-6">
                <a href="/" title="خانه" class="hover:scale-110 transition-transform">
                    <i data-lucide="home" class="w-6 h-6 text-gray-800"></i>
                </a>
                <a asp-area="Account" asp-page="/Search" title="جستجو" class="hover:scale-110 transition-transform">
                    <i data-lucide="search" class="w-6 h-6 text-gray-800"></i>
                </a>
                <a href="#" title="پیام‌ها" class="hover:scale-110 transition-transform">
                    <i data-lucide="send" class="w-6 h-6 text-gray-800"></i>
                </a>
                <a asp-page="/Posts/Create" title="پست جدید" class="hover:scale-110 transition-transform">
                    <i data-lucide="plus-square" class="w-6 h-6 text-gray-800"></i>
                </a>
                <a href="#" title="اعلان‌ها" class="hover:scale-110 transition-transform">
                    <i data-lucide="heart" class="w-6 h-6 text-gray-800"></i>
                </a>
                @if (cookieService.UserIsLoggedIn())
                {
                    <a asp-area="Account" asp-page="/Profile" asp-route-userId="@cookieService.GetUserId()" title="پروفایل" class="hover:scale-110 transition-transform">
                        <div class="w-8 h-8 rounded-full overflow-hidden border-2 border-gray-300 bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-sm">
                            ک
                        </div>
                    </a>
                }
                else
                {
                    <a asp-area="Account" asp-page="/Login" class="btn-primary px-4 py-2 text-sm rounded-lg">
                        ورود
                    </a>
                }
            </nav>
        </div>
    </header>

    <!-- فاصله برای هدر ثابت -->
    <div class="pt-16 min-h-screen">
        @RenderBody()
    </div>

    <!-- الرت سفارشی -->
    <div id="customAlert" class="hidden fixed bottom-6 left-1/2 -translate-x-1/2 bg-gray-900 text-white px-6 py-3 rounded-full shadow-2xl z-[100]">
        <p id="alertText" class="text-sm font-medium"></p>
    </div>

    <!-- Scripts -->
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script>
        // فعال‌سازی آیکون‌های Lucide
        document.addEventListener("DOMContentLoaded", () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>